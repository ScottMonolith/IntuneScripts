function Get-MultipleRegistryKeys { 
    [CmdletBinding()]
    param (
        [Parameter(Mandatory = $true)]
        [array]$RegistrySettings
    )

    foreach ($setting in $RegistrySettings) {
        $RegistryPath = $setting.RegistryPath
        $KeyName = $setting.KeyName
        $ValueData = $setting.ValueData
        try {
            $null = Get-ItemPropertyValue -Path "$RegistryPath" -Name $KeyName
        }
        catch {
            Write-Host "Key could not be found."
            return $false
        }
        # Check if the registry key has the correct setting
        if ($ValueData -ne (Get-ItemPropertyValue -Path "$RegistryPath" -Name $KeyName)) {
            # Return false if the registry key doesn't exist
            Write-Host "Key doesn't have the correct setting."
            return $false
        }
        else {
            $true
        }
    }
}

# Define an array of registry settings to set
$registrySettings = @(
    @{
        RegistryPath = "HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION"
        KeyName = "Excel.exe"
        ValueType = "DWord"
        ValueData = 1
    },
    @{
        RegistryPath = "HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION"
        KeyName = "Graph.exe"
        ValueType = "DWord"
        ValueData = 1
    },
    @{
        RegistryPath = "HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION"
        KeyName = "MSAccess.exe"
        ValueType = "DWord"
        ValueData = 1
    },
    @{
        RegistryPath = "HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION"
        KeyName = "MSPub.exe"
        ValueType = "DWord"
        ValueData = 1
    },
    @{
        RegistryPath = "HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION"
        KeyName = "Powerpnt.exe"
        ValueType = "DWord"
        ValueData = 1
    },
    @{
        RegistryPath = "HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION"
        KeyName = "Visio.exe"
        ValueType = "DWord"
        ValueData = 1
    },
    @{
        RegistryPath = "HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION"
        KeyName = "WinProj.exe"
        ValueType = "DWord"
        ValueData = 1
    },
    @{
        RegistryPath = "HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION"
        KeyName = "WinWord.exe"
        ValueType = "DWord"
        ValueData = 1
    },
    @{
        RegistryPath = "HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION"
        KeyName = "Wordpad.exe"
        ValueType = "DWord"
        ValueData = 1
    }
)

# Call the function to get the registry settings
Get-MultipleRegistryKeys -RegistrySettings $registrySettings
